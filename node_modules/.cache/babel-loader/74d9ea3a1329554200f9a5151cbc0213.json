{"ast":null,"code":"import { ref } from 'vue';\nimport jsQR from 'jsqr'; // Import the jsQR library\n\nexport default {\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    const purpose = ref('');\n    const status = ref('returned');\n    const keyinfo_id = ref('');\n    const pickup_photo_path_upload = ref('');\n    const video = ref(null);\n    let scannerInterval;\n    let scanning = false;\n\n    const startScanner = () => {\n      scanning = true;\n      scannerInterval = setInterval(scanQRCode, 1000);\n    };\n\n    const stopScanner = () => {\n      scanning = false;\n      clearInterval(scannerInterval);\n    };\n\n    const captureImage = () => {\n      if (scanning) {\n        const canvas = document.createElement('canvas');\n        canvas.width = video.value.videoWidth;\n        canvas.height = video.value.videoHeight;\n        const context = canvas.getContext('2d');\n        context.drawImage(video.value, 0, 0, canvas.width, canvas.height);\n        canvas.toBlob(function (blob) {\n          if (blob) {\n            const imageUrl = URL.createObjectURL(blob);\n            const capturedImage = document.getElementById('capturedImage');\n            capturedImage.src = imageUrl;\n            capturedImage.style.display = 'block'; // Use .value to update the ref\n\n            pickup_photo_path_upload.value = imageUrl;\n            const downloadImageLink = document.getElementById('downloadImageLink');\n            downloadImageLink.href = imageUrl;\n            downloadImageLink.style.display = 'block';\n            const link = document.createElement('a');\n            link.href = imageUrl;\n            link.download = 'pickup_image.jpeg';\n            link.click();\n            const uploadInput = document.createElement('input');\n            uploadInput.type = 'file';\n            uploadInput.value = imageUrl;\n            uploadInput.name = 'pickup_photo_path_upload';\n            uploadInput.style.display = 'none'; // Append the uploadInput to the appropriate form element\n\n            document.getElementById('pickupForm').appendChild(uploadInput);\n          }\n        }, 'image/jpeg');\n      }\n    };\n\n    const submitForm = () => {\n      const url = 'http://keyman-env.eba-dhwuuaiv.us-east-1.elasticbeanstalk.com/api/contractors/1/keypickups';\n      const headers = {\n        'Authorization': 'Bearer 17|jnWPdWo8JoCK9EJZc2fLp3rmYYRBUtyLIyt301s6',\n        'Accept': 'application/json'\n      };\n      const formData = new FormData(document.getElementById('pickupForm'));\n      fetch(url, {\n        method: 'POST',\n        headers,\n        body: formData\n      }).then(response => response.json()).then(data => {\n        console.log(data);\n      }).catch(error => {\n        console.error(error);\n      });\n    };\n\n    const scanQRCode = () => {\n      if (scanning) {\n        const canvas = document.createElement('canvas');\n        canvas.width = video.value.videoWidth;\n        canvas.height = video.value.videoHeight;\n        const context = canvas.getContext('2d');\n        context.drawImage(video.value, 0, 0, canvas.width, canvas.height);\n        const imageData = context.getImageData(0, 0, canvas.width, canvas.height); // Make sure to import 'jsQR' library\n\n        const code = jsQR(imageData.data, imageData.width, imageData.height);\n\n        if (code) {\n          keyinfo_id.value = code.data;\n        }\n      }\n    };\n\n    const __returned__ = {\n      purpose,\n      status,\n      keyinfo_id,\n      pickup_photo_path_upload,\n      video,\n      scannerInterval,\n      scanning,\n      startScanner,\n      stopScanner,\n      captureImage,\n      submitForm,\n      scanQRCode,\n      ref,\n      jsQR\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n\n};","map":{"version":3,"mappings":"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","names":["ref","jsQR","purpose","status","keyinfo_id","pickup_photo_path_upload","video","scannerInterval","scanning","startScanner","setInterval","scanQRCode","stopScanner","clearInterval","captureImage","canvas","document","createElement","width","value","videoWidth","height","videoHeight","context","getContext","drawImage","toBlob","blob","imageUrl","URL","createObjectURL","capturedImage","getElementById","src","style","display","downloadImageLink","href","link","download","click","uploadInput","type","name","appendChild","submitForm","url","headers","formData","FormData","fetch","method","body","then","response","json","data","console","log","catch","error","imageData","getImageData","code"],"sources":["C:/xampp/htdocs/keyman-vue/src/views/PostContractorKeypickup.vue"],"sourcesContent":["<template>\r\n    <div>\r\n      <!-- Breadcrumb -->\r\n      <Breadcrumb breadcrumb=\"PostContractorKeypickups\" />\r\n  \r\n      <div class=\"mt-8\">\r\n        <h4 class=\"text-gray-600\">POST Contractor Key Pickup</h4>\r\n        <form id=\"pickupForm\">\r\n          <div class=\"form-row\">\r\n            <div class=\"mt-4\">\r\n              <label for=\"purpose\">Purpose:</label>\r\n              <input type=\"text\" class=\"px-4 py-2 border rounded-md\" id=\"purpose\" name=\"purpose\" required v-model=\"purpose\" />\r\n            </div>\r\n            <div class=\"mt-4\">\r\n              <label for=\"status\">Status:</label>\r\n              <select class=\"form-control\" id=\"status\" name=\"status\" required v-model=\"status\">\r\n                <option value=\"returned\">Returned</option>\r\n                <option value=\"unreturned\">Unreturned</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"mt-4\">\r\n              <label for=\"keyinfo_id\">Keyinfo ID:</label>\r\n              <input type=\"text\" class=\"form-control\" id=\"keyinfo_id\" name=\"keyinfo_id\" required v-model=\"keyinfo_id\" />\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"mt-4\">\r\n              <label for=\"qrScanner\">QR Code Scanner:</label>\r\n              <video ref=\"video\" autoplay playsinline></video>\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"mt-6\">\r\n              <button type=\"button\" class=\"btn btn-primary\" @click=\"startScanner\">Start Scanner</button>\r\n              <button type=\"button\" class=\"btn btn-danger\" @click=\"stopScanner\">Stop Scanner</button>\r\n              <button type=\"button\" class=\"btn btn-success\" @click=\"captureImage\">Capture Image</button>\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"mt-6\">\r\n              <!-- Image preview -->\r\n              <img id=\"capturedImage\" src=\"\" alt=\"Captured Image\" style=\"max-width: 100%; max-width: 500px; display: none;\" />\r\n              <!-- Include a hidden input field to store the captured image data URL -->\r\n              <input type=\"hidden\" id=\"pickup_photo_path_upload\" name=\"pickup_photo_path_upload\" v-model=\"pickup_photo_path_upload\" />\r\n              <!-- Download link for the captured image -->\r\n              <a id=\"downloadImageLink\" class=\"btn btn-primary\" style=\"display: none;\" download=\"pickup_image.jpeg\">Download Image</a><br />\r\n              <!-- Include a hidden input field to store the captured image data URL -->\r\n              <input type=\"file\" id=\"pickup_photo_path\" name=\"pickup_photo_path\" />\r\n            </div>\r\n            <div class=\"mt-4\">\r\n              <button type=\"button\" class=\"btn btn-primary\" @click=\"submitForm\">Submit</button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </template>\r\n  \r\n  <script setup>\r\nimport { ref } from 'vue';\r\nimport jsQR from 'jsqr'; // Import the jsQR library\r\n\r\nconst purpose = ref('');\r\nconst status = ref('returned');\r\nconst keyinfo_id = ref('');\r\nconst pickup_photo_path_upload = ref('');\r\nconst video = ref(null);\r\nlet scannerInterval;\r\nlet scanning = false;\r\n\r\nconst startScanner = () => {\r\n  scanning = true;\r\n  scannerInterval = setInterval(scanQRCode, 1000);\r\n};\r\n\r\nconst stopScanner = () => {\r\n  scanning = false;\r\n  clearInterval(scannerInterval);\r\n};\r\n\r\nconst captureImage = () => {\r\n  if (scanning) {\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = video.value.videoWidth;\r\n    canvas.height = video.value.videoHeight;\r\n    const context = canvas.getContext('2d');\r\n    context.drawImage(video.value, 0, 0, canvas.width, canvas.height);\r\n\r\n    canvas.toBlob(function (blob) {\r\n      if (blob) {\r\n        const imageUrl = URL.createObjectURL(blob);\r\n\r\n        const capturedImage = document.getElementById('capturedImage');\r\n        capturedImage.src = imageUrl;\r\n        capturedImage.style.display = 'block';\r\n\r\n        // Use .value to update the ref\r\n        pickup_photo_path_upload.value = imageUrl;\r\n\r\n        const downloadImageLink = document.getElementById('downloadImageLink');\r\n        downloadImageLink.href = imageUrl;\r\n        downloadImageLink.style.display = 'block';\r\n\r\n        const link = document.createElement('a');\r\n        link.href = imageUrl;\r\n        link.download = 'pickup_image.jpeg';\r\n        link.click();\r\n\r\n        const uploadInput = document.createElement('input');\r\n        uploadInput.type = 'file';\r\n        uploadInput.value = imageUrl;\r\n        uploadInput.name = 'pickup_photo_path_upload';\r\n        uploadInput.style.display = 'none';\r\n        // Append the uploadInput to the appropriate form element\r\n        document.getElementById('pickupForm').appendChild(uploadInput);\r\n      }\r\n    }, 'image/jpeg');\r\n  }\r\n};\r\n\r\nconst submitForm = () => {\r\n  const url = 'http://keyman-env.eba-dhwuuaiv.us-east-1.elasticbeanstalk.com/api/contractors/1/keypickups';\r\n  const headers = {\r\n    'Authorization': 'Bearer 17|jnWPdWo8JoCK9EJZc2fLp3rmYYRBUtyLIyt301s6',\r\n    'Accept': 'application/json',\r\n  };\r\n\r\n  const formData = new FormData(document.getElementById('pickupForm'));\r\n\r\n  fetch(url, {\r\n    method: 'POST',\r\n    headers,\r\n    body: formData,\r\n  })\r\n    .then((response) => response.json())\r\n    .then((data) => {\r\n      console.log(data);\r\n    })\r\n    .catch((error) => {\r\n      console.error(error);\r\n    });\r\n};\r\n\r\nconst scanQRCode = () => {\r\n  if (scanning) {\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = video.value.videoWidth;\r\n    canvas.height = video.value.videoHeight;\r\n    const context = canvas.getContext('2d');\r\n    context.drawImage(video.value, 0, 0, canvas.width, canvas.height);\r\n\r\n    const imageData = context.getImageData(0, 0, canvas.width, canvas.height);\r\n\r\n    // Make sure to import 'jsQR' library\r\n    const code = jsQR(imageData.data, imageData.width, imageData.height);\r\n\r\n    if (code) {\r\n      keyinfo_id.value = code.data;\r\n    }\r\n  }\r\n};\r\n</script>"]},"metadata":{},"sourceType":"module"}